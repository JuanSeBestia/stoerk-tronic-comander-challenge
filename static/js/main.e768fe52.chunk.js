(this["webpackJsonpstoerk-tronic-comander-challenge"]=this["webpackJsonpstoerk-tronic-comander-challenge"]||[]).push([[0],{54:function(e,t,a){},55:function(e,t,a){},59:function(e,t,a){},68:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(10),c=a.n(s),i=(a(54),a(55),a(15)),o=a(99),l=a(36),u=a.n(l),d=(a(59),a(9)),O=a.n(d),j="MMM DD HH:mm:ss",b={On:"green",INVALID:"red",Off:"gray"};var f={chart:{height:350,type:"rangeBar"},plotOptions:{bar:{horizontal:!0,distributed:!0,barHeight:"90%",dataLabels:{hideOverflowingLabels:!1}}},dataLabels:{enabled:!1},xaxis:{type:"datetime"},yaxis:{show:!0},tooltip:{x:{show:!1,format:"dd MMM HH:mm"},y:{show:!1},custom:function(e){e.series;var t=e.seriesIndex,a=e.dataPointIndex,n=e.w;return function(e){var t=e.color,a=e.seriesName,n=e.ylabel,r=e.start,s=e.end,c=e.diff;return'<div class="apexcharts-tooltip-rangebar"><div> <span class="series-name" style="color: '+t+'">'+(a||"")+'<span style="color:'+b[n]+';"> : '+n+" <span> ("+c+')</span></span></span></div><div><span class="value start-value">'+r+'</span> <span class="separator">-</span> <span class="value end-value">'+s+"</span></div></div>"}({color:n.globals.colors[t],seriesName:n.config.series[t].data[a].x,ylabel:n.config.series[t].data[a].state,start:O()(n.globals.seriesRangeStart[t][a]).format(j),end:O()(n.globals.seriesRangeEnd[t][a]).format(j),diff:function(e,t){var a=O()(e),n=O()(t).diff(a,"hours");return"for "+n+(n>1?" hours":" hour")}(n.globals.seriesRangeStart[t][a],n.globals.seriesRangeEnd[t][a])})}},grid:{row:{colors:["#f3f4f5","#fff"],opacity:.5}}},m=a(37),v=a(3);var h,p,x,g,S,N,y,E=function(){return Object(v.jsxs)("div",{className:"text-center",children:[Object(v.jsx)(m.a,{icon:"spinner",spin:!0,size:"10x",className:"text-primary"}),Object(v.jsx)("h3",{className:"text-primary my-2",children:"LOADING ..."})]})},I=a(14),C=a.n(I),F=a(7);!function(e){e.DEVICE="DEVICE",e.COMPRESSOR="COMPRESSOR",e.FAN="FAN",e.LIGHT="LIGHT"}(h||(h={})),function(e){e.ON="On",e.OFF="Off",e.INVALID="INVALID"}(p||(p={}));var T="#75757533",A="#5189C8",D="#8973D6",L="#F2BB38",M="#72E8A7",R=(y={},Object(F.a)(y,h.DEVICE,(x={},Object(F.a)(x,p.OFF,T),Object(F.a)(x,p.ON,A),Object(F.a)(x,p.INVALID,"#5189C866"),x)),Object(F.a)(y,h.COMPRESSOR,(g={},Object(F.a)(g,p.OFF,T),Object(F.a)(g,p.ON,D),Object(F.a)(g,p.INVALID,"#8973D666"),g)),Object(F.a)(y,h.FAN,(S={},Object(F.a)(S,p.OFF,T),Object(F.a)(S,p.ON,L),Object(F.a)(S,p.INVALID,"#F2BB3866"),S)),Object(F.a)(y,h.LIGHT,(N={},Object(F.a)(N,p.OFF,T),Object(F.a)(N,p.ON,M),Object(F.a)(N,p.INVALID,"#72E8A766"),N)),y);var P=function(e){return Object.values(e).flatMap((function(e){return e})).map((function(e){return{x:e.type,y:[O()(e.from).valueOf(),O()(e.to).valueOf()],fillColor:R[e.type][e.state],state:e.state}}))},V=C.a.memoize((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"commander-1";return[{title:t,data:P(e)}]}));var B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;return new Promise((function(t){setTimeout(t,e)}))};var H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return e.reduce((function(a,n,r){if(0===r)return[{from:n.timestamp,to:"",type:n.type,state:n.state}];var s=e[r-1],c=a[a.length-1];return c.state===n.state&&O()(s.timestamp).add(t,"hours").isSameOrAfter(n.timestamp)||(c.to=n.timestamp,c={from:n.timestamp,to:"",type:n.type,state:n.state},a.push(c)),r===e.length-1&&(c.to=n.timestamp),a}),[])};function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,a=e[e.length-1];if(!a)return p.ON;if(Math.random()>t){var n=Object.values(p).filter((function(e){return e!==a.state}));return C.a.sample(n)}return a.state}function k(e,t,a){a[e].push({state:w(a[e]),timestamp:t,type:e})}var G=function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O()(),a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O()(t).add(70,"days"),n=(e={},Object(F.a)(e,h.DEVICE,[]),Object(F.a)(e,h.COMPRESSOR,[]),Object(F.a)(e,h.FAN,[]),Object(F.a)(e,h.LIGHT,[]),e),r=function(e){Object.values(h).forEach((function(t){return k(t,e,n)}))},s=O()(t);s.isSameOrBefore(a);s=O()(s).add(10,"hours"))r(s);return n};function z(e,t,a){return a.components.includes(t)?H(e[t]):[]}var K={getEvents:function(e){return B().then((function(){return G(e.dates.from,e.dates.to)})).then((function(t){return Object.keys(t).reduce((function(a,n){return a[n]=t[n].filter((function(t){return e.states.includes(t.state)})),a}),{})})).then((function(t){var a;return a={},Object(F.a)(a,h.DEVICE,z(t,h.DEVICE,e)),Object(F.a)(a,h.COMPRESSOR,z(t,h.COMPRESSOR,e)),Object(F.a)(a,h.FAN,z(t,h.FAN,e)),Object(F.a)(a,h.LIGHT,z(t,h.LIGHT,e)),a})).then((function(e){return console.log("eventCommanderAPI:",{data:e}),e}))}};var q=function(e){var t,a=Object(n.useState)(!0),r=Object(i.a)(a,2),s=r[0],c=r[1],o=Object(n.useState)(void 0),l=Object(i.a)(o,2),u=l[0],d=(l[1],Object(n.useState)((t={},Object(F.a)(t,h.DEVICE,[]),Object(F.a)(t,h.COMPRESSOR,[]),Object(F.a)(t,h.FAN,[]),Object(F.a)(t,h.LIGHT,[]),t))),O=Object(i.a)(d,2),j=O[0],b=O[1];return Object(n.useEffect)((function(){c(!0),K.getEvents(e).then(b).finally((function(){return c(!1)}))}),[e]),[j,s,u]},J=a(11),Q=a(98),U=a(97),W=a(100),X=a(46);function Y(e,t){return!!e.find((function(e){return C.a.isEqual(t,e)}))}var Z=function(e){var t=e.controlId,a=e.field,n=e.setField,r=e.options,s=e.label;return Object(v.jsx)(o.a.Body,{children:Object(v.jsxs)(Q.a.Group,{controlId:t,children:[Object(v.jsx)(Q.a.Label,{children:s}),r.map((function(e){return Object(v.jsx)(Q.a.Check,{id:e.id,type:"checkbox",name:e.id,label:e.text,onChange:function(){return n(function(e,t){var a=e.find((function(e){return C.a.isEqual(t,e)}));return a?e.filter((function(e){return e!==a})):[].concat(Object(X.a)(e),[t])}(a,e.value))},checked:Y(a,e.value),style:e.color?{color:e.color}:void 0})}))]})})},$=a(96);var _,ee=function(e){var t=e.controlId,a=e.field,n=e.setField,r=e.labelFrom,s=e.labelTo;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)($.a,{id:"".concat(t,"-from"),label:r,type:"datetime-local",value:a.from.toISOString().split(".")[0],onChange:function(e){return t=e.target.value,n(Object(J.a)(Object(J.a)({},a),{},{from:O()(t)}));var t},variant:"outlined",className:"mx-3",InputLabelProps:{shrink:!0}}),Object(v.jsx)($.a,{id:"".concat(t,"-from"),label:s,type:"datetime-local",value:a.to.toISOString().split(".")[0],onChange:function(e){return t=e.target.value,n(Object(J.a)(Object(J.a)({},a),{},{to:O()(t)}));var t},variant:"outlined",className:"mx-3",InputLabelProps:{shrink:!0}})]})};!function(e){e.COMPONENTS="COMPONENTS",e.STATES="STATES",e.DATES="DATES"}(_||(_={}));var te=Object.values(h).map((function(e){return{text:e,value:e,id:e,color:R[e][p.ON]}})),ae=Object.values(p).map((function(e){return{text:e,value:e,id:e}})),ne=function(e){var t=e.filterState,a=e.setFilterState,r=Object(n.useRef)(null),s=t.components,c=t.states,i=t.dates;return Object(v.jsx)(Q.a,{ref:r,children:Object(v.jsx)(U.a,{children:Object(v.jsxs)(o.a,{children:[Object(v.jsxs)(o.a.Header,{className:"d-flex flex-row justify-content-between align-items-center",children:[Object(v.jsx)("h3",{className:"text-primary",children:"Select filter"}),Object(v.jsxs)("div",{children:[Object(v.jsx)(U.a.Toggle,{className:"mx-2",as:W.a,eventKey:_.COMPONENTS,size:"lg",children:"Components"}),Object(v.jsx)(U.a.Toggle,{className:"mx-2",as:W.a,eventKey:_.STATES,size:"lg",children:"States"}),Object(v.jsx)(U.a.Toggle,{className:"mx-2",as:W.a,eventKey:_.DATES,size:"lg",children:"Dates"})]})]}),Object(v.jsx)(U.a.Collapse,{eventKey:_.COMPONENTS,children:Object(v.jsx)(o.a.Body,{children:Object(v.jsx)(Z,{controlId:"components",options:te,label:"Select components",setField:function(e){return a(Object(J.a)(Object(J.a)({},t),{},{components:e}))},field:s})})}),Object(v.jsx)(U.a.Collapse,{eventKey:_.STATES,children:Object(v.jsx)(o.a.Body,{children:Object(v.jsx)(Z,{controlId:"states",options:ae,label:"Select states",setField:function(e){return a(Object(J.a)(Object(J.a)({},t),{},{states:e}))},field:c})})}),Object(v.jsx)(U.a.Collapse,{eventKey:_.DATES,children:Object(v.jsx)(o.a.Body,{children:Object(v.jsx)(ee,{controlId:"dates",field:i,setField:function(e){return a(Object(J.a)(Object(J.a)({},t),{},{dates:e}))},labelFrom:"Start date",labelTo:"Final date"})})})]})})})},re={components:Object.values(h),states:Object.values(p),dates:{from:O()().add(-10,"days"),to:O()()}};var se=function(){var e=Object(n.useState)(re),t=Object(i.a)(e,2),a=t[0],r=t[1],s=q(a),c=Object(i.a)(s,3),l=c[0],d=c[1],O=(c[2],V(l));return Object(v.jsxs)("div",{className:"Commander",children:[Object(v.jsxs)("h1",{className:"text-primary text-center",children:["Commander: ",O[0].title]}),Object(v.jsxs)(o.a,{className:"m-3",children:[Object(v.jsx)("div",{children:Object(v.jsx)(ne,{filterState:a,setFilterState:r})}),Object(v.jsx)("div",{id:"chart",children:d?Object(v.jsx)(E,{}):Object(v.jsx)(u.a,{options:f,series:O,type:"rangeBar",height:500})})]})]})},ce=a(45),ie=a(30);ce.a.library.add(ie.a,ie.b);var oe=function(){return Object(v.jsxs)("div",{className:"App",children:[Object(v.jsx)("header",{className:"App-header",children:"Commander app"}),Object(v.jsx)("main",{children:Object(v.jsx)(se,{})})]})},le=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,101)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),s(e),c(e)}))};c.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(oe,{})}),document.getElementById("root")),le()}},[[68,1,2]]]);
//# sourceMappingURL=main.e768fe52.chunk.js.map