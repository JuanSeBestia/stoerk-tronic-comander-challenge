(this["webpackJsonpstoerk-tronic-comander-challenge"]=this["webpackJsonpstoerk-tronic-comander-challenge"]||[]).push([[0],{70:function(e,t,a){},71:function(e,t,a){},75:function(e,t,a){},85:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),s=a.n(c),i=(a(70),a(71),a(21)),o=a(122),l=a(51),d=a.n(l),j=(a(75),a(11)),O=a.n(j),u="MMM DD HH:mm:ss",b={On:"green",INVALID:"red",Off:"gray"};var f={chart:{height:350,type:"rangeBar"},plotOptions:{bar:{horizontal:!0,distributed:!0,barHeight:"90%",dataLabels:{hideOverflowingLabels:!1}}},dataLabels:{enabled:!1},xaxis:{type:"datetime"},yaxis:{show:!0},tooltip:{x:{show:!1,format:"dd MMM HH:mm"},y:{show:!1},custom:function(e){e.series;var t=e.seriesIndex,a=e.dataPointIndex,n=e.w;return function(e){var t=e.color,a=e.seriesName,n=e.ylabel,r=e.start,c=e.end,s=e.diff;return'<div class="apexcharts-tooltip-rangebar"><div> <span class="series-name" style="color: '+t+'">'+(a||"")+'<span style="color:'+b[n]+';"> : '+n+" <span> ("+s+')</span></span></span></div><div><span class="value start-value">'+r+'</span> <span class="separator">-</span> <span class="value end-value">'+c+"</span></div></div>"}({color:n.globals.colors[t],seriesName:n.config.series[t].data[a].x,ylabel:n.config.series[t].data[a].state,start:O()(n.globals.seriesRangeStart[t][a]).format(u),end:O()(n.globals.seriesRangeEnd[t][a]).format(u),diff:function(e,t){var a=O()(e),n=O()(t).diff(a,"hours");return"for "+n+(n>1?" hours":" hour")}(n.globals.seriesRangeStart[t][a],n.globals.seriesRangeEnd[t][a])})}},grid:{row:{colors:["#f3f4f5","#fff"],opacity:.5}}},m=a(52),h=a(4);var v,p,x,g,S,N,I,y=function(){return Object(h.jsxs)("div",{className:"text-center",children:[Object(h.jsx)(m.a,{icon:"spinner",spin:!0,size:"10x",className:"text-primary"}),Object(h.jsx)("h3",{className:"text-primary my-2",children:"LOADING ..."})]})},E=a(20),C=a.n(E),F=a(7);!function(e){e.DEVICE="DEVICE",e.COMPRESSOR="COMPRESSOR",e.FAN="FAN",e.LIGHT="LIGHT"}(v||(v={})),function(e){e.ON="On",e.OFF="Off",e.INVALID="INVALID"}(p||(p={}));var T="#75757533",A="#5189C8",D="#8973D6",L="#F2BB38",M="#72E8A7",R=(I={},Object(F.a)(I,v.DEVICE,(x={},Object(F.a)(x,p.OFF,T),Object(F.a)(x,p.ON,A),Object(F.a)(x,p.INVALID,"#5189C866"),x)),Object(F.a)(I,v.COMPRESSOR,(g={},Object(F.a)(g,p.OFF,T),Object(F.a)(g,p.ON,D),Object(F.a)(g,p.INVALID,"#8973D666"),g)),Object(F.a)(I,v.FAN,(S={},Object(F.a)(S,p.OFF,T),Object(F.a)(S,p.ON,L),Object(F.a)(S,p.INVALID,"#F2BB3866"),S)),Object(F.a)(I,v.LIGHT,(N={},Object(F.a)(N,p.OFF,T),Object(F.a)(N,p.ON,M),Object(F.a)(N,p.INVALID,"#72E8A766"),N)),I);var P=function(e){return Object.values(e).flatMap((function(e){return e})).map((function(e){return{x:e.type,y:[O()(e.from).valueOf(),O()(e.to).valueOf()],fillColor:R[e.type][e.state],state:e.state}}))},k=C.a.memoize((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"commander-1";return[{title:t,data:P(e)}]}));var B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;return new Promise((function(t){setTimeout(t,e)}))};var H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return e.reduce((function(a,n,r){if(0===r)return[{from:n.timestamp,to:"",type:n.type,state:n.state}];var c=e[r-1],s=a[a.length-1];return s.state===n.state&&O()(c.timestamp).add(t,"hours").isSameOrAfter(n.timestamp)||(s.to=n.timestamp,s={from:n.timestamp,to:"",type:n.type,state:n.state},a.push(s)),r===e.length-1&&(s.to=n.timestamp),a}),[])};function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,a=e[e.length-1];if(!a)return p.ON;if(Math.random()>t){var n=Object.values(p).filter((function(e){return e!==a.state}));return C.a.sample(n)}return a.state}function w(e,t,a){a[e].push({state:V(a[e]),timestamp:t,type:e})}var G=function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O()(),a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O()(t).add(70,"days"),n=(e={},Object(F.a)(e,v.DEVICE,[]),Object(F.a)(e,v.COMPRESSOR,[]),Object(F.a)(e,v.FAN,[]),Object(F.a)(e,v.LIGHT,[]),e),r=function(e){Object.values(v).forEach((function(t){return w(t,e,n)}))},c=O()(t);c.isSameOrBefore(a);c=O()(c).add(10,"hours"))r(c);return n};function z(e,t,a){return a.components.includes(t)?H(e[t]):[]}var K={getEvents:function(e){return B().then((function(){return G(e.dates.from,e.dates.to)})).then((function(t){return Object.keys(t).reduce((function(a,n){return a[n]=t[n].filter((function(t){return e.states.includes(t.state)})),a}),{})})).then((function(t){var a;return a={},Object(F.a)(a,v.DEVICE,z(t,v.DEVICE,e)),Object(F.a)(a,v.COMPRESSOR,z(t,v.COMPRESSOR,e)),Object(F.a)(a,v.FAN,z(t,v.FAN,e)),Object(F.a)(a,v.LIGHT,z(t,v.LIGHT,e)),a})).then((function(e){return console.log("eventCommanderAPI:",{data:e}),e}))}};var q=function(e){var t,a=Object(n.useState)(!0),r=Object(i.a)(a,2),c=r[0],s=r[1],o=Object(n.useState)(void 0),l=Object(i.a)(o,2),d=l[0],j=(l[1],Object(n.useState)((t={},Object(F.a)(t,v.DEVICE,[]),Object(F.a)(t,v.COMPRESSOR,[]),Object(F.a)(t,v.FAN,[]),Object(F.a)(t,v.LIGHT,[]),t))),O=Object(i.a)(j,2),u=O[0],b=O[1];return Object(n.useEffect)((function(){s(!0),K.getEvents(e).then(b).finally((function(){return s(!1)}))}),[e]),[u,c,d]},J=a(14),Q=a(118),U=a(120),W=a(59),X=a(62);function Y(e,t){return!!e.find((function(e){return C.a.isEqual(t,e)}))}var Z=function(e){var t=e.controlId,a=e.field,n=e.setField,r=e.options,c=e.label;return Object(h.jsx)(o.a.Body,{children:Object(h.jsxs)(Q.a.Group,{controlId:t,children:[Object(h.jsx)(Q.a.Label,{children:c}),r.map((function(e){return Object(h.jsx)(Q.a.Check,{id:e.id,type:"checkbox",name:e.id,label:e.text,onChange:function(){return n(function(e,t){var a=e.find((function(e){return C.a.isEqual(t,e)}));return a?e.filter((function(e){return e!==a})):[].concat(Object(X.a)(e),[t])}(a,e.value))},checked:Y(a,e.value),style:e.color?{color:e.color}:void 0})}))]})})},$=a(116);var _,ee=function(e){var t=e.controlId,a=e.field,n=e.setField,r=e.labelFrom,c=e.labelTo;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)($.a,{id:"".concat(t,"-from"),label:r,type:"datetime-local",value:a.from.toISOString().split(".")[0],onChange:function(e){return t=e.target.value,n(Object(J.a)(Object(J.a)({},a),{},{from:O()(t)}));var t},variant:"outlined",className:"mx-3",InputLabelProps:{shrink:!0}}),Object(h.jsx)($.a,{id:"".concat(t,"-from"),label:c,type:"datetime-local",value:a.to.toISOString().split(".")[0],onChange:function(e){return t=e.target.value,n(Object(J.a)(Object(J.a)({},a),{},{to:O()(t)}));var t},variant:"outlined",className:"mx-3",InputLabelProps:{shrink:!0}})]})};!function(e){e.COMPONENTS="COMPONENTS",e.STATES="STATES",e.DATES="DATES"}(_||(_={}));var te=Object.values(v).map((function(e){return{text:e,value:e,id:e,color:R[e][p.ON]}})),ae=Object.values(p).map((function(e){return{text:e,value:e,id:e}})),ne=function(e){var t=e.filterState,a=e.setFilterState,r=Object(n.useRef)(null),c=t.components,s=t.states,i=t.dates;return Object(h.jsx)(Q.a,{ref:r,children:Object(h.jsx)(U.a,{children:Object(h.jsxs)(o.a,{children:[Object(h.jsxs)(o.a.Header,{className:"d-flex flex-row justify-content-between align-items-center",children:[Object(h.jsx)("h3",{className:"text-primary",children:"Select filter"}),Object(h.jsxs)("div",{children:[Object(h.jsx)(U.a.Toggle,{className:"mx-2",as:W.a,eventKey:_.COMPONENTS,size:"lg",children:"Components"}),Object(h.jsx)(U.a.Toggle,{className:"mx-2",as:W.a,eventKey:_.STATES,size:"lg",children:"States"}),Object(h.jsx)(U.a.Toggle,{className:"mx-2",as:W.a,eventKey:_.DATES,size:"lg",children:"Dates"})]})]}),Object(h.jsx)(U.a.Collapse,{eventKey:_.COMPONENTS,children:Object(h.jsx)(o.a.Body,{children:Object(h.jsx)(Z,{controlId:"components",options:te,label:"Select components",setField:function(e){return a(Object(J.a)(Object(J.a)({},t),{},{components:e}))},field:c})})}),Object(h.jsx)(U.a.Collapse,{eventKey:_.STATES,children:Object(h.jsx)(o.a.Body,{children:Object(h.jsx)(Z,{controlId:"states",options:ae,label:"Select states",setField:function(e){return a(Object(J.a)(Object(J.a)({},t),{},{states:e}))},field:s})})}),Object(h.jsx)(U.a.Collapse,{eventKey:_.DATES,children:Object(h.jsx)(o.a.Body,{children:Object(h.jsx)(ee,{controlId:"dates",field:i,setField:function(e){return a(Object(J.a)(Object(J.a)({},t),{},{dates:e}))},labelFrom:"Start date",labelTo:"Final date"})})})]})})})},re={components:Object.values(v),states:Object.values(p),dates:{from:O()().add(-10,"days"),to:O()()}};var ce=function(){var e=Object(n.useState)(re),t=Object(i.a)(e,2),a=t[0],r=t[1],c=q(a),s=Object(i.a)(c,3),l=s[0],j=s[1],O=(s[2],k(l));return Object(h.jsxs)("div",{className:"Commander",children:[Object(h.jsxs)("h1",{className:"text-primary text-center my-5",children:["Commander: ",O[0].title]}),Object(h.jsxs)(o.a,{className:"m-3",children:[Object(h.jsx)("div",{children:Object(h.jsx)(ne,{filterState:a,setFilterState:r})}),Object(h.jsx)("div",{id:"chart",children:j?Object(h.jsx)(y,{}):Object(h.jsx)(d.a,{options:f,series:O,type:"rangeBar",height:500})})]})]})},se=a.p+"static/media/logo-stor.89e05a91.jpeg",ie=a(60),oe=a(47),le=a(119),de=a(121),je=a(117);ie.a.library.add(oe.a,oe.b);var Oe=function(){return Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)("header",{className:"App-header",children:Object(h.jsxs)(le.a,{bg:"light",expand:"lg",children:[Object(h.jsxs)(le.a.Brand,{href:"#home",children:[Object(h.jsx)("img",{className:"d-none d-md-inline mx-2",src:se,alt:"Logo"})," ",Object(h.jsx)("span",{className:"text-primary",children:"Commander app"})]}),Object(h.jsx)(le.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(h.jsx)(le.a.Collapse,{id:"basic-navbar-nav",children:Object(h.jsxs)(de.a,{className:"mr-auto",children:[Object(h.jsx)(de.a.Link,{href:"#home",children:"Home"}),Object(h.jsx)(de.a.Link,{href:"#link",children:"Events"}),Object(h.jsxs)(je.a,{title:"Dropdown",id:"basic-nav-dropdown",children:[Object(h.jsx)(je.a.Item,{href:"#action/3.1",children:"Action"}),Object(h.jsx)(je.a.Item,{href:"#action/3.2",children:"Another action"}),Object(h.jsx)(je.a.Item,{href:"#action/3.3",children:"Something"}),Object(h.jsx)(je.a.Divider,{}),Object(h.jsx)(je.a.Item,{href:"#action/3.4",children:"Separated link"})]})]})})]})}),Object(h.jsx)("main",{children:Object(h.jsx)(ce,{})})]})},ue=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,123)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),c(e),s(e)}))};s.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(Oe,{})}),document.getElementById("root")),ue()}},[[85,1,2]]]);
//# sourceMappingURL=main.0527bfbb.chunk.js.map